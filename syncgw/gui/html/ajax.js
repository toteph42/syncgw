var sgwAjax=Array(8);function sgwAjaxStart(c,a){try{sgwAjax[0]=new XMLHttpRequest()}catch(d){try{sgwAjax[0]=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{sgwAjax[0]=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){sgwAjax[0]=null}}}if(!sgwAjax[0]){alert("Error creating request object - cannot retrieve any message data!");return}sgwAjax[1]=null;sgwAjax[2]=c;sgwAjax[6]="-1/-1/"+a;sgwQuery(1)}function sgwQuery(a){if(sgwAjax[1]){clearTimeout(sgwAjax[1])}if(a){sgwAjax[5]=0}if(sgwAjax[3]){if(sgwAjax[5]<=3000){sgwAjax[5]+=500}}else{if(sgwAjax[5]<=10000){sgwAjax[5]+=500}}sgwAjax[1]=setTimeout("sgwQuery(0)",sgwAjax[5]);if(sgwAjax[0].readyState!=3){var b=new Date();sgwAjax[0].open("GET",sgwAjax[2]+"&c="+sgwAjax[6]+"&u="+b.getTime(),true);sgwAjax[0].onreadystatechange=sgwGetData;sgwAjax[0].send(null)}}function sgwGetData(){if(sgwAjax[0].readyState==4){if(sgwAjax[0].status==200){var k=sgwAjax[0].responseText.split("\n");var j=null;var e=0;var b;for(var f=0;f<k.length-1;f++){var d=k[f].slice(1,2);if(d=="6"){b=document.getElementById("sgwCmd")}else{b=document.getElementById("sgwMsg")}switch(k[f].slice(0,1)){case"0":b.innerHTML=" ";break;case"1":var g=document.createElement("div");g.innerHTML=k[f].slice(2);var a=b.appendChild(g);if(!j){j=a}e=1;break;case"2":var g=document.createElement("div");g.innerHTML=k[f].slice(2);if(!j){for(j=b.firstChild;j;j=j.nextSibling){if(j.nodeType===1){break}}}j=b.insertBefore(g,j);e=1;break;case"3":sgwAjax[6]=k[f].slice(2);break;default:break}}if(e){var l=sgwAjax[6].toString();var h=l.split("/");if(h[2]==2){b.scrollTop=b.scrollHeight}else{b=document.getElementById("sgwCmd");j=document.getElementById("sgwCmdPos");if(j.value>-1&&b.scrollHeight>j.value){b.scrollTop=j.value}b=document.getElementById("sgwMsg");j=document.getElementById("sgwMsgPos");if(j.value>-1&&b.scrollHeight>j.value){b.scrollTop=j.value}}sgwQuery(1)}}}}function sgwAjaxStop(c){var a,d,b;c=typeof c!=="undefined"?c:1;if(sgwAjax[1]){clearTimeout(sgwAjax[1]);sgwAjax[1]=null}a=document.getElementById("sgwCmd");d=document.getElementById("sgwCmdPos");if(a){d.value=a.scrollTop}a=document.getElementById("sgwMsg");d=document.getElementById("sgwMsgPos");if(a){d.value=a.scrollTop}if(!c){return}for(b=(a==null?-1:a.childNodes.length-1);b>=0;b--){if(a.childNodes[b].nodeName=="DIV"){a.removeChild(a.childNodes[b])}}}function sgwAjaxToggle(c,b,a,g){var h=document.getElementById(c);var d=document.getElementById(b);if(sgwAjax[1]){sgwAjaxStop(0);sgwAjax[3]=h.value;sgwAjax[4]=h.title;h.value=a;h.title=g;d.style.display="";d.style.visibility="visible"}else{h.value=sgwAjax[3];h.title=sgwAjax[4];d.style.visibility="hidden";d.style.display="none";sgwQuery(1)}};